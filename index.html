<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>World Clock</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100vh;
            background: linear-gradient(135deg, #f7f7ff, #dfe9ff);
            color: #333;
            transition: background-color 0.5s ease, color 0.5s ease;
        }

        body.dark-mode {
            background: linear-gradient(135deg, #222, #333);
            color: #fff;
        }

        h1 {
            font-size: 2.5rem;
            margin-bottom: 20px;
            color: #4c6ef5;
        }

        .container {
            background: rgba(255, 255, 255, 0.9);
            border-radius: 15px;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
            padding: 20px;
            width: 80%;
            max-width: 600px;
            text-align: center;
            transition: background-color 0.5s ease, color 0.5s ease;
        }

        .container.dark-mode {
            background: rgba(0, 0, 0, 0.8);
            color: #fff;
        }

        .clock-container {
            margin: 20px 0;
        }

        .digital-clock {
            font-size: 2rem;
            font-weight: bold;
            color: #4c6ef5;
        }

        .analog-clock {
            position: relative;
            width: 200px;
            height: 200px;
            margin: 0 auto;
            background: radial-gradient(circle, #fff, #e0eafc);
            border: 4px solid #4c6ef5;
            border-radius: 50%;
            box-shadow: inset 0 0 10px rgba(0, 0, 0, 0.1);
        }

        .analog-clock::before,
        .analog-clock::after {
            content: '';
            position: absolute;
            background: #4c6ef5;
        }

        .analog-clock::before {
            width: 2px;
            height: 100px;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%) rotate(90deg);
        }

        .analog-clock::after {
            width: 100px;
            height: 2px;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
        }

        .controls {
            margin-top: 20px;
        }

        .controls select, .controls button {
            margin: 5px;
            padding: 10px 15px;
            font-size: 1rem;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            background: #4c6ef5;
            color: white;
            transition: background 0.3s ease, transform 0.2s ease;
        }

        .controls select:hover, .controls button:hover {
            background: #3b5bdb;
            transform: scale(1.05);
        }

        .time-difference {
            font-size: 1.2rem;
            margin-top: 10px;
            color: #666;
        }

        footer {
            margin-top: 20px;
            font-size: 0.9rem;
            color: #666;
        }

        #map {
            width: 100%;
            height: 400px;
            margin-top: 20px;
        }

        ul {
            list-style: none;
            padding: 0;
        }

        li {
            margin: 5px 0;
        }

        @media (max-width: 600px) {
            h1 {
                font-size: 2rem;
            }

            .container {
                padding: 10px;
            }

            .digital-clock {
                font-size: 1.5rem;
            }

            .analog-clock {
                width: 150px;
                height: 150px;
            }
        }
    </style>
</head>
<body>
    <h1>Relógio Mundial</h1>

    <div class="container">
        <div class="clock-container">
            <div id="digital-clock" class="digital-clock">Carregando...</div>
            <div id="analog-clock" class="analog-clock"></div>
        </div>

        <div class="controls">
            <label for="country-select">Selecione um país:</label>
            <select id="country-select">
                <option value="America/New_York">Nova York (EST)</option>
                <option value="Europe/London">Londres (GMT)</option>
                <option value="Asia/Tokyo">Tóquio (JST)</option>
                <option value="Australia/Sydney">Sydney (AEST)</option>
                <option value="Brazil/East">Brasília (BRT)</option>
                <option value="Asia/Kolkata">Nova Déli (IST)</option>
                <option value="Africa/Cairo">Cairo (EET)</option>
                <option value="Europe/Paris">Paris (CET)</option>
                <option value="Asia/Shanghai">Pequim (CST)</option>
                <option value="Asia/Dubai">Dubai (GST)</option>
                <option value="Europe/Moscow">Moscou (MSK)</option>
                <option value="America/Los_Angeles">Los Angeles (PST)</option>
                <option value="America/Chicago">Chicago (CST)</option>
                <option value="America/Mexico_City">Cidade do México (CST)</option>
                <option value="Canada/Mountain">Calgary (MST)</option>
                <option value="Pacific/Honolulu">Honolulu (HST)</option>
                <option value="Asia/Bangkok">Bangcoc (ICT)</option>
                <option value="Asia/Seoul">Seul (KST)</option>
                <option value="Asia/Jakarta">Jacarta (WIB)</option>
                <option value="Europe/Berlin">Berlim (CET)</option>
                <option value="Europe/Rome">Roma (CET)</option>
                <option value="Europe/Madrid">Madri (CET)</option>
                <option value="Europe/Stockholm">Estocolmo (CET)</option>
                <option value="Europe/Istanbul">Istambul (TRT)</option>
            </select>
            <button onclick="toggleClockType()">Alternar Relógio</button>
            <button onclick="toggleDarkMode()">Alternar Modo Escuro</button>
        </div>

        <div id="time-difference" class="time-difference"></div>

        <div id="favorites-section">
            <h3>Favoritos</h3>
            <ul id="favorites"></ul>
            <button onclick="addToFavorites()">Adicionar aos Favoritos</button>
        </div>

        <div id="history-section">
            <h3>Histórico</h3>
            <ul id="history"></ul>
        </div>
    </div>

    <div id="map"></div>

    <footer>
        Desenvolvido por [Seu Nome] | Todos os direitos reservados.
    </footer>

    <script src="https://unpkg.com/leaflet@1.9.3/dist/leaflet.js"></script>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.3/dist/leaflet.css" />

    <script>
        let clockType = 'digital';
        let intervalId = null;
        let startTime = null;
        let elapsedTime = 0;

        function updateTime() {
            const selectedCountry = document.getElementById('country-select').value;
            const localTime = new Date();
            const utcTime = localTime.getTime() + (localTime.getTimezoneOffset() * 60000);
            const countryTime = new Date(Intl.DateTimeFormat().resolvedOptions().timeZone === selectedCountry ? utcTime : (new Date()).toLocaleString("en-US", { timeZone: selectedCountry }));

            if (clockType === 'digital') {
                document.getElementById('digital-clock').textContent = `Horário em ${selectedCountry}: ${countryTime.toLocaleTimeString()}`;
            } else {
                updateAnalogClock(countryTime);
            }

            const hoursDifference = Math.floor(Math.abs((localTime - countryTime) / 1000 / 60 / 60));
            const minutesDifference = Math.floor(Math.abs((localTime - countryTime) / 1000 / 60) % 60);
            document.getElementById('time-difference').textContent = `Diferença de horário: ${hoursDifference} horas e ${minutesDifference} minutos`;

            addToHistory(selectedCountry, countryTime.toLocaleTimeString());
        }

        function updateAnalogClock(time) {
            const hour = time.getHours() % 12;
            const minute = time.getMinutes();
            const second = time.getSeconds();

            const hourHand = document.querySelector('.analog-clock::before');
            const minuteHand = document.querySelector('.analog-clock::after');

            hourHand.style.transform = `translate(-50%, -50%) rotate(${hour * 30 + minute * 0.5}deg)`;
            minuteHand.style.transform = `translate(-50%, -50%) rotate(${minute * 6}deg)`;
        }

        setInterval(updateTime, 1000);

        function toggleClockType() {
            clockType = clockType === 'digital' ? 'analog' : 'digital';
            document.getElementById('digital-clock').style.display = clockType === 'digital' ? 'block' : 'none';
            document.querySelector('.analog-clock').style.display = clockType === 'analog' ? 'block' : 'none';
        }

        function toggleDarkMode() {
            document.body.classList.toggle('dark-mode');
        }

        function addToFavorites() {
            const selectedCountry = document.getElementById('country-select').value;
            const favorites = JSON.parse(localStorage.getItem('favorites')) || [];
            if (!favorites.includes(selectedCountry)) {
                favorites.push(selectedCountry);
                localStorage.setItem('favorites', JSON.stringify(favorites));
                renderFavorites();
            }
        }

        function renderFavorites() {
            const favoritesList = document.getElementById('favorites');
            favoritesList.innerHTML = '';
            const favorites = JSON.parse(localStorage.getItem('favorites')) || [];
            favorites.forEach(country => {
                const li = document.createElement('li');
                li.textContent = country;
                favoritesList.appendChild(li);
            });
        }

        renderFavorites();

        function addToHistory(country, time) {
            const historyList = document.getElementById('history');
            const li = document.createElement('li');
            li.textContent = `Horário em ${country}: ${time}`;
            historyList.appendChild(li);
        }

        const map = L.map('map').setView([0, 0], 2);

        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
            maxZoom: 18,
            attribution: '© OpenStreetMap'
        }).addTo(map);

        map.on('click', function(e) {
            const latlng = e.latlng;
            const timezone = tzlookup(latlng.lat, latlng.lng); // Usar API como https://github.com/evansiroky/timezone-boundary-builder
            alert(`Horário em ${timezone}: ${new Date().toLocaleString("en-US", { timeZone: timezone })}`);
        });

        function startCronometer() {
            if (!intervalId) {
                startTime = Date.now() - elapsedTime;
                intervalId = setInterval(updateCronometer, 10);
            }
        }

        function pauseCronometer() {
            if (intervalId) {
                clearInterval(intervalId);
                intervalId = null;
            }
        }

        function resetCronometer() {
            pauseCronometer();
            elapsedTime = 0;
            document.getElementById('cronometer').textContent = "00:00:00";
        }

        function updateCronometer() {
            elapsedTime = Date.now() - startTime;
            const hours = Math.floor(elapsedTime / 3600000);
            const minutes = Math.floor((elapsedTime % 3600000) / 60000);
            const seconds = Math.floor((elapsedTime % 60000) / 1000);
            document.getElementById('cronometer').textContent = `${padZero(hours)}:${padZero(minutes)}:${padZero(seconds)}`;
        }

        function padZero(num) {
            return num.toString().padStart(2, '0');
        }
    </script>
</body>
</html>
